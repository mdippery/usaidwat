#!/usr/bin/env ruby

require 'usaidwat'


class String
  def undent
    self.gsub(/^.{#{slice(/^ +/).length}}/, '')
  end
end


def die(code=1)
  $stderr.puts "usaidwat v#{USaidWat::VERSION}"
  $stderr.puts "Usage: #{File.basename $0} <subcommand> [options]"
  $stderr.puts "
    The most commonly used usaidwat commands are:
        list   Show user's last 100 comments for a given subreddit
        show   Show a specific comment from a user
        where  Show where a user posts most often.".undent
  exit code
end

die if ARGV.length < 1

subc = ARGV.shift
require_path = "usaidwat/cmd/#{subc}"
begin
  require require_path
  USaidWat.send subc.gsub('-', '_').to_sym
rescue LoadError => e
  $stderr.puts "usaidwat: command '#{subc}' not found"
  exit 2
end
